
<!DOCTYPE html>
<html>
    <head>
        <title>Mapa</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
        <meta charset="utf-8">
        <style>
            /* Always set the map height explicitly to define the size of the div
             * element that contains the map. */
            #map {
                height: 100%;
            }
            /* Optional: Makes the sample page fill the window. */
            html, body {
                height: 100%;
                margin: 0;
                padding: 0;
            }
            .infimg {
                max-width: 200px !important;
            }
            .infimgcont {
                max-height: 75px;
                overflow: hidden;
            }
            h1 {
                font-size: 1.5em;
                margin-top: 0.4em;
                margin-bottom: 0.4em;
            }
            h2 {
                font-size: 1.1em;
                font-weight: normal !important;
                margin-top: 0.3em;
                margin-bottom: 0.3em;
                color: #999;
            }
        </style>
    </head>
    <body>
        <div id="map"></div>
        <script>
            var map;
            var lastinfowindow = null;
            function initMap() {
                map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 14,
                    center: new google.maps.LatLng(19.3018838, -99.1882839),
                    mapTypeId: 'roadmap'
                });

                var iconBase = '';
                var imgBase = 'https://bbva.cariai.com/maps/';

                function addMarker(feature) {
                    var marker = new google.maps.Marker({
                        position: new google.maps.LatLng(feature.lat, feature.long),
                        icon: iconBase + feature.icon,
                        map: map
                    });
                    return marker;
                }

                function addInfoWindow(feature, marker) {
                    var content = null;
                    if (feature.title || feature.subtitle || feature.img || feature.text) {
                        console.log(feature);
                        content = '<div id="content">';
                        if (feature.title) {
                            content += '<h1>' + feature.title + '</h1>';
                        }
                        if (feature.subtitle) {
                            content += '<h2>' + feature.subtitle + '</h2>';
                        }
                        if (feature.img) {
                            content += '<div class="infimgcont"><img class="infimg" src="' + imgBase + feature.img + '" /></div>';
                        }
                        if (feature.imgUrl) {
                            content += '<div class="infimgcont"><img class="infimg" src="' + feature.imgUrl + '" /></div>';
                        }
                        if (feature.text) {
                            content += '<p>' + feature.text + '</p>';
                        }
                        if (feature.urlText) {
                            content += '<br><a href="' + feature.url + '"  target="_blank">' + feature.urlText + '</a>';
                        }

                        if (feature.text !== "Ud se encuentra aquí") {

var promosUrl = 'https://bbva.cariai.com/bbva/promocionesWhatsapp.php?cat=Restaurantes&operation=promos&codCat=';content += '<br><a href="https://bbva.cariai.com/bbva/promocionesWhatsapp.php?cat=Restaurantes&operation=promos&codCat=&id=' + feature.id +'" target="_blank">Ver las promociones</a>';
                        }
                    }
                    content += '</div>';
                    var infowindow = new google.maps.InfoWindow({
                            content: content,
                            maxWidth: 200
                        });
                        /*
                    if (content) {
                        var infowindow = new google.maps.InfoWindow({
                            content: content,
                            maxWidth: 200
                        });
                    }*/
                    marker.addListener('click', function () {
                        //infoWindow.setContent(content);
                        if(lastinfowindow !== null){
                            lastinfowindow.close();
                        }
                        infowindow.setContent(content);
                        infowindow.open(map, marker);
                        lastinfowindow = infowindow;
                    });
                }

                var features = [
                    {
                        lat : 19.3018838,
                        long : -99.1882839,
                        icon : "https://bbva.cariai.com/maps_bancomer/usuarios.png",
                        text : "Ud se encuentra aquí",
                        title : "",
                        subtitle: "",
                        img: "",
                        urlText : "",
                        url : "",
                        imgUrl : "",
                        id : ""
                    },                    {
                        lat : 19.30214238,
                        long : -99.1891192,
                        icon : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        text : "CUSPIDE PARQUES DEL PEDREGAL",
                        title : "KFE",
                        subtitle: " ",
                        img: "",
                        urlText : "Ver como llegar",
                        url : "https://www.google.com/maps/dir/19.3018838,-99.1882839/19.30214238,-99.1891192",
                        imgUrl : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        id : "40009487"
                    },                    {
                        lat : 19.30272353,
                        long : -99.18987904,
                        icon : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        text : "BLV ADOLFO LOPEZ AMP JDNS DEL PEDREGAL",
                        title : "Starbucks",
                        subtitle: " ",
                        img: "",
                        urlText : "Ver como llegar",
                        url : "https://www.google.com/maps/dir/19.3018838,-99.1882839/19.30272353,-99.18987904",
                        imgUrl : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        id : "40115748"
                    },                    {
                        lat : 19.30272353,
                        long : -99.18987904,
                        icon : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        text : "BLV PERIF SUR 4690 PB 604 JARD DEL PEDREGAL DE SAN ANGEL",
                        title : "Italianni's",
                        subtitle: " ",
                        img: "",
                        urlText : "Ver como llegar",
                        url : "https://www.google.com/maps/dir/19.3018838,-99.1882839/19.30272353,-99.18987904",
                        imgUrl : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        id : "40113467"
                    },                    {
                        lat : 19.30272353,
                        long : -99.18987904,
                        icon : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        text : "PERIF SUR 4690 JARDINES DEL PEDREGAL DE SAN A",
                        title : "100% Natural",
                        subtitle: " ",
                        img: "",
                        urlText : "Ver como llegar",
                        url : "https://www.google.com/maps/dir/19.3018838,-99.1882839/19.30272353,-99.18987904",
                        imgUrl : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        id : "40073239"
                    },                    {
                        lat : 19.302715765,
                        long : -99.189938446,
                        icon : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        text : "ANILLO PERIF SUR 4690 AMPL DEL PEDREGAL",
                        title : "Domino's Pizza",
                        subtitle: " ",
                        img: "",
                        urlText : "Ver como llegar",
                        url : "https://www.google.com/maps/dir/19.3018838,-99.1882839/19.302715765,-99.189938446",
                        imgUrl : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        id : "40111705"
                    },                    {
                        lat : 19.304329,
                        long : -99.189969,
                        icon : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        text : "PERIFERICO SUR JARDINES DEL PEDREGAL",
                        title : "RESTAURANTE MIYAKO",
                        subtitle: " ",
                        img: "",
                        urlText : "Ver como llegar",
                        url : "https://www.google.com/maps/dir/19.3018838,-99.1882839/19.304329,-99.189969",
                        imgUrl : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        id : "40009274"
                    },                    {
                        lat : 19.301285033,
                        long : -99.192032081,
                        icon : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        text : "PERIF SUR 6399 ARENAL TEPEPAN",
                        title : "Burger King",
                        subtitle: " ",
                        img: "",
                        urlText : "Ver como llegar",
                        url : "https://www.google.com/maps/dir/19.3018838,-99.1882839/19.301285033,-99.192032081",
                        imgUrl : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        id : "40110604"
                    },                    {
                        lat : 19.308387445,
                        long : -99.186529466,
                        icon : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        text : "AV INSURGENTES SUR 3185 INSURGENTES CUICULCO",
                        title : "Vips",
                        subtitle: " ",
                        img: "",
                        urlText : "Ver como llegar",
                        url : "https://www.google.com/maps/dir/19.3018838,-99.1882839/19.308387445,-99.186529466",
                        imgUrl : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        id : "40110938"
                    },                    {
                        lat : 19.304425728,
                        long : -99.180395133,
                        icon : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        text : "CEFIRO 91 C OCASO NO 3 INSURGENTES",
                        title : "Pizza Hut",
                        subtitle: " ",
                        img: "",
                        urlText : "Ver como llegar",
                        url : "https://www.google.com/maps/dir/19.3018838,-99.1882839/19.304425728,-99.180395133",
                        imgUrl : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        id : "40068105"
                    },                    {
                        lat : 19.298044,
                        long : -99.180952,
                        icon : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        text : "AV SAN FERNANDO BARRIO SAN FERNANDO",
                        title : "RESTAURANTE SPOLETO",
                        subtitle: " ",
                        img: "",
                        urlText : "Ver como llegar",
                        url : "https://www.google.com/maps/dir/19.3018838,-99.1882839/19.298044,-99.180952",
                        imgUrl : "https://bbva.cariai.com/maps_bancomer/icn_bares.png",
                        id : "40007681"
                    },                ];

                for (var i = 0, feature; feature = features[i]; i++) {
                    var marker = addMarker(feature);
                    addInfoWindow(feature, marker);
                }
            }
            function doNothing() {}
        </script>
        <script async defer
                src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBjsINSH5x39Ks6c0_CoS1yr1Mb3cB3cVo&callback=initMap">
        </script>
    </body>
</html>